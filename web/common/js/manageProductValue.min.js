(function() {
    var productsValue={};
    var pageConfig={
    	teamsValue:productsValue,
    	bodyId:'#ProductValueEle',
    	detailId:'#modalManageProductValue',
    	getCom:'getProductValues',
    	insertCom:'insertProductValue',
    	deleteCom:'deleteProductValue',
    	editCom:'editProductValue',
    	detailTemplate:'manageProductValueDetail.html',
        editTemplate:'manageProductValueEditDetail.html',
        editId:'#modalProductValue',
        addConfig:function(item){
            var newItem={};
            if(item.hasOwnProperty('productName')){
                newItem.productNameDisabled=true;
                newItem.productName=item.productName;
                newItem.updateDate=(new Date()).toLocaleDateString().replace(/\//g,'-');
            }else{
                newItem.updateDate=(new Date()).toLocaleDateString().replace(/\//g,'-');                
            }
            return newItem;
        },
        editController:function(config,data){
            $.getJSON('getHistoryValuesById',{productId:data.productId,pageNo:1,pageSize:50},function(result){
                    console.log(result);
                    var historyData=$.extend(data,{productName:data.productName});
                    historyData.historyData=result.data;
                    $.bindData.compileAll($('#modalProductValue'),historyData);
                    console.log(historyData);
            });            
        },
        beforeEditPost:function(beforeData){
            var tempData=$.extend(beforeData,{});
            tempData.historyData=JSON.stringify(beforeData.historyData);
            return tempData;
        }
    }
    $.setPage(pageConfig);
    productsValue.getDataByPageIndex(1);
})()